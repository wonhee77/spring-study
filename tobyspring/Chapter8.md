# 8장 스프링이란 무엇인가?

## 8.1 스프링의 정의

### 요약
스프링에 대해 가장 잘 알려진 정의는 이렇다.  
`자바 엔터프라이즈 개발을 편하게 해주는 오픈소스 경량급 애플리케이션 프레임워크`

#### 애플리케이션 프레임워크
애플리케이션 프레임워크는 특정 계층이나, 기술, 업무 분야에 국한되지 않고 애플리케이션 전 영역을 포괄하는 범용적인 프레임워크를 말한다. 애플리케이션 프레임워크는  
애플리케이션 개발의 전 과정을 빠르고 편리하며 효율적으로 진행하는데 일차적인 목표를 두는 프레임워크다. 스프링은 로드 존슨이 J2EE 애플리케이션 설계와 개발의 모든  
영역에 대한 개발 전략을 다룬 책이다. 이 책에 소개된 독창적인 개발 전략과 기존 기술에 대한 대안은 설명으로만 그치지 않고, 그 개념을 증명할 수 있도록 만들어진 3만  
라인가량의 샘플 애플리케이션 형태로 제공하였고 이게 스프링의 원시 버전이다.  

스프링의 일차적인 존재 목적은 핵심 기술에 담긴 프로그래밍 모델을 일관되게 적용해서 엔터프라이즈 애플리케이션 전 계층과 전 영역에 전략과 기능을 제공해줌으로써  
애플리케이션을 편리하게 개발하게 해주는 애플리케이션 프레임워크로 사용되는 것임을 기억해두자.

#### 경량급
스프링이 경럅급이라는 건 스프링 자체가 아주 가볍다거나 작은 규모의 코드로 이뤄졌다는 뜻은 아니다. 스프링이 가볍다고 하는 이뉴는 불필요하게 무겁지 않다는 의미다.  
이는 스프링의 기원이 된 책에서 비판하는 자바 엔터프라이즈 기술의 불필요한 복잡함에 반대되는 개념이다. 기존의 EJB는 기술에 대한 과도한 욕심으로 인해 개발환경과  
운용서버, 개발과 빌드, 테스트 과저으 작성된 코드 모두를 매우 무겁고 복잡하게 만들었다. 그에 반해 스프링은 가장 단순한 서버환경인 톰캣이나 제티에서도 완벽하게  
동작한다. 

#### 자바 엔터프라이즈 개발을 편하게
스프링은 애플리케이션 개발자들이 스프링이라는 프레임워크가 제공하는 기술이 아니라 자신이 작성하는 애플리케이션의 로직에 더 많은 관심과 시간을 쏟게 해준다. 초기에  
스프링의 기본 설정과 적용 기술만 잘 선택하고 준비해두면, 이후로 애플리케이션 개발 중에는 스프링과 관련된 코드나 API에 대해 개발자가 거의 신경 쓸 일이 없다.  

#### 오픈소스
오픈소스의 장점은 공개된 커뮤니티 공간 안에서 투명한 방식으로 다양한 참여를 통해 개발되기 때문에 매우 빠르고 유연한 개발이 가능하다는 것이다. 

## 8.2 스프링의 목적

### 요약

#### 엔터프라이즈 개발의 복잡함
2000년대 초반에는 자바 엔터프라이즈 프로젝트는 80% 이상이 실패했다고 한다. 여러 원인이 있었지만 그 중 가장 대표적인 게 엔터프라이즈 시스템 개발이 너무   
복잡해져서였다.  

복잡함의 근본적인 이유
첫번째, 기술의 제약조건과 요구사항이 늘어가기 때문이다.  
엔터프라이즈 시스템이랑 서버에서 동작하면서 기업과 조직의 업무를 처리해주는 시스템을 말한다. 엔터프라이즈 시스템은 많은 사용자의 요청을 동시에 처리해야 하기 때문에  
서버의 자원을 효율적으로 공유하고 분배해서 사용할 수 있어야 한다. 또한 중요한 기업의 핵심 정보를 처리하거나 미션 크리티컬한 금융, 원자력, 항공, 국방 등의 시스템을  
다르기도 하기 때문에 보안과 안정성, 확장성 면에서도 뛰어나야 한다. 따라서 이런 종류의 기술적인 문제를 고려하면서 애플리케이션을 개발해야 하는 부담을 안게 된다.  

두번째, 엔터프라이즈 애플리케이션이 구현해야 할 핵심 기능인 비즈니스 로직의 복잡함이 증가하기 때문이다.  
갈수록 엔터프라이즈 시스템을 이용해 기업의 핵심 업무를 처리하는 비율이 늘어났고, 점차 대부분의 업무 처리는 컴퓨터를 이용하지 않고는 아예 진행하기 힘들 만큼  
엔터프라이즈 시스템에 대한 업무 의존도가 높아졌다. 그만큼 다양하고 복잡한 업무 처리 기능을 엔터프라이즈 시스템이 구현해야 했다는 뜻이다.

복잡함을 가중시키는 요인  
엔터프라이즈 애플리케이션 개발이 실패하는 주요 원인은 비즈니스 로직의 복잡함과 기술적인 복잡함이다. 자바 엔터프라이즈 시스템 개발이 어려운 가장 큰 이유는 근본적인  
비즈니스 로직과 엔터프라이즈 기술이라는 두 가지 복잡함이 한데 얽혀 있기 때문이다. 전통적인 자바 엔터프라이즈 개발 기법은 대부분 비즈니스 로직의 복잡함 구현 코드와  
엔터프라이즈 서비스를 이용하는 기술적인 코드가 자꾸 혼재될 수 밖에 없는 방식이었다. 결국 개발자가 동시에 그 두가지를 모두 신경 써서 개발해야하는 과도한 부담을 줬고,  
그에 따라 전체적인 복잡함은 몇 배로 가중됐다.  

제거될 수 없는 근본적인 복잡함  
엔터프라이즈 개발의 근본적인 복잡함의 원인은 제거할 대상은 아니다. 대신 그 복잡함을 효과적으로 상대할 수 있는 전략과 기법이 필요하다. 문제는 비즈니스 로직의 복잡함을  
효과적으로 처리하는 데 적용되는 방법이 다르다는 점이다. 따라서 두 가지 복잡함이 코드에 한데 어우러져 나타나는 전통적인 개발 방식에서는 효과적으로 복잡함을 다루기가  
힘들다. 따라서 가장 먼저 할일은 성격이 다른 이 두 가지 복잡함을 분리해내는 것이다. 

실패한 해결책: EJB  
EJB의 기본 전략도 이 두 가지 종류의 복잡함을 분리하는 것이었다. 하지만 EJB 환경에서 동작하기 위해 특정 인터페이스를 구현하고, 특정 클래스를 상속하고, 서버에  
종속적인 서비스를 통해서만 접근하고 사용이 가능하게 만드는 개발방식은 잘못된 선택이었다. 오히려 EJB라는 환경과 스펙에 종속되는 코드로 만들어져야하는 더 큰 부담을  
안게 됐다. EJB는 결국 일부 기술적인 복잡함을 덜어주려는 시도를 하다가 오히려 더 큰 복잡함을 추가하는 실수를 범했다.

비침투적인 방식을 통한 효과적인 해결책: 스프링  
스프링은 EJB의 실패를 교훈으로 삼아서 출발했다. EJB처럼 어떤 기술을 적용했을 때 그 기술과 관련된 코드나 규약 등이 코드에 등작하는 경우를 침투적인 기술이라고 부른다.  
반면에 비침투적인 기술은 기술의 적용 사실이 코드에 직접 반영되지 않는다는 특징이 있다. 어딘가에는 기술의 적용에 따라 필요한 작업을 해줘야 하겠지만, 애플리케이션  
코드 여기저기에 불쑥 등장하거나, 코드의 설계와 구현 방식을 제한하지 않는다는게 비침투적인 기술의 특징이다.

기술적 복잡함을 상대하는 전략  

첫번째 문제: 기술에 대한 접근 방식이 일관성이 없고, 특정 환경에 종속적이다  
목적이 유사하지만 호환이 안 되는 표준, 비표준, 오픈소스, 상용 제품 등이 제공하는 각기 다른 API를 사용하도록 코드를 일일이 변경해야 하는 번거로움이 발생한다.  
이렇게 일관성이 없는 기술과 서버환경의 변화에 대한 스프링의 공략 방법은 바로 서비스 추상화다. 기술적인 복잡함은 일단 추상화를 통해 로우레벨의 기술 구현 부분과 기술을  
사용하는 인터페이스를 분리하고, 환경과 세부 기술에 독립적인 접근 인터페이스를 제공하는 것이 가장 좋은 해결책이다.  

두번째 문제: 기술적인 처리를 담당하는 코드가 성격이 다른 코드에 섞여서 등장한다  
AOP는 최후까지 애플리케이션 로직을 담당하는 코드에 남아 있는 기술 관련 코드를 깔끔하게 분리해서 별도의 모듈로 관리하게 해주는 강력한 기술이다. AOP를 적용하지  
않았을 때는 기술과 비즈니스 로직이 지저분하게 얽혀서 다루기 힘들다는 문제도 있었지만, 기술적인 코드가 여기저기 중복돼서 나타난다는 것도 심각한 문제점이다. AOP는  
기술을 다루는 코드로 인한 복잡함이 기술 그 자체 이상으로 불필요하게 증대되지 않도록 도와주는 가장 강력한 수단이다.  

비즈니스와 애플리케이션 로직의 복잡함을 상대하는 전략  
비즈니스 로직을 담은 코드는 애플리케이션에서 가장 중요한 핵심이 되는 부분이다. 또한 업무의 변화에 따라 자주 변경되거나 수정되는 부분이기도 하다. 그래서 비즈니스  
로직은 가장 중요하게 다뤄져야 하고 가장 많이 신경 써야 한다. 예전에는 비즈니스 로직의 상당 부분을 DB에 두는 것이 유행이었다. SQL을 통해 비즈니스 로직을 표현하고,  
DB에서 동작하는 저장 프로시저를 통해 핵심 로직을 처리하는 경우도 많았다. 엔터프라이즈 시스템 개발의 흐름은 점차 비즈니스 로직은 애플리케이션 안에서 처리하도록 만드는  
추세다. DB는 단지 데이터의 영구적인 저장과 복잡한 조건을 가진 검색과 같은 자체적으로 특화된 기능에만 활용하고, 데이터를 분석하고 가공하고 그에 따라 로직을 처리하는  
부분은 확장하기 쉽고, 비용도 싼 애플리케이션 서버 쪽으로 이동하는 것이다.  

핵심 도구: 객체지향과 DI  
기술과 비즈니스 로직의 복잡함을 해결하는 데 스프링이 공통적으로 사용하는 도구가 있다. 바로 객체지향이다. 스프링 개발자는 자바 엔터프라이즈 기술의 가장 큰 장점은 바로  
객체지향 설계와 프로그래밍을 가능하게 해주는 자바 언어라고 생각했다. 스프링의 모토는 결국 "기본으로 돌아가자"이다. 자바의 기본인 객체지향에 충실한 설계가 가능하도록  
단순한 오브젝트로 개발할 수 있고, 객체지향의 설계 기법을 잘 적용할 수 있는 구조를 만들기 위해 DI 같은 유용한 기술을 편하게 적용하도록 도와주는 것이 스프링의 기본  
전략이다. 그리고 DI는 객체지향 설계 기술이 없이는 그 존재의미가 없다. DI란 특별한 기술이라기보다는 유연하게 확장할 수 있는 오브젝트를 설계하다보면 자연스럽게  
적용하게 되는 객체지향 프로그래밍 기법일 뿐이다. 결국 DI는 좋은 오브젝트 설계의 결과물이기도 하지만, 반대로 DI를 열심히 적용하다 보면 객체지향 설계의 원칙을 잘  
따르고 그 장점을 살린 설계가 나올 수도 있다. 


## 8.3 POJO 프로그래밍

### 요약
스프링의 핵심 개발자들이 함께 쓴 Professional Spring Framework라는 책에서 스프링의 핵심 개발자들은 "스프링의 정수는 엔터프라이즈 서비스 기능을 POJO에  
제공하는 것"이라고 했다. 분리됐지만 반드시 필요한 엔터프라이즈 서비스 기술을 POJO 방식으로 개발된 애플리케이션 핵심 로직을 담은 코드에 제공한다는 것이 스프링의  
가장 강력한 특징과 목표다. 

#### 스프링의 핵심 POJO
스프링 애플리케이션은 POJO를 이용해서 만든 애플리케이션 코드와, POJO가 어떻게 관계를 맺고 동작하는지를 정의해놓은 설계정보로 구분된다. DI의 기본 아이디어는  
유연하게 확장 가능한 오브젝트를 만들어두고 그 관계는 외부에서 다이내믹하게 설정해준다는 것이다. 이런 DI의 개념을 애플리케이션 전반에 걸쳐 적용하는 것이 스프링의  
프로그래밍 모델이다. 스프링의 주요 기술인 IoC/DI, AOP와 PSA(Portable Service Abstraction)은 애플리케이션을 POJO로 개발할 수 있게 해주는 가능기술  
이라고 불린다. 

#### POJO란 무엇인가
POJO는 Plain Old Java Object의 첫 글자를 따서 만든 약자다. 자바의 단순한 오브젝트를 이용해 애플리케이션의 비즈니스 로직을 구현하는 편이 낫다고 생각했으나  
EJB와 다르게 이러한 용어가 없어서 마틴 파울러가 POJO라는 용어를 만들었다. 

POJO는 단순하게 보자면 그냥 평범한 자바오브젝트라고 할 수 있지만 좀 더 명확하게 하자면 적어도 다음 세가지는 충족해야 POJO라고 불릴 수 있다.  

특정 규약에 종속되지 않는다  
POJO는 자바 언어와 꼭 필요한 API 외에는 종속되지 않아야 한다. 특정 규약을 따라 만들게 하는 경우는 대부분 규약에서 제시하는 특정 클래스를 상속하도록 요구한다.  
그럴 경우 자바의 단일 상속 제한 때문에 더 이상 해당 클래스에 객체지향적인 설계 기법을 적용하기가 어려워지는 문제가 생긴다. 

특정 환경에 종속되지 않는다  
순수한 애플리케이션 로직을 담고 있는 오브젝트 코드가 특정 환경에 종속되게 만드는 경우라면 POJO라고 할 수 없다.  
비즈니스 로직을 담은 코드에 HttpServletRequest나 HttpSession, 캐시와 관련된 API가 등장하거나 웹 프레임워크의 클래스를 직접 이용하는 부분이 있다면  
그것은 진정한 POJO라고 볼 수 없다. 

그저 평범한 자바 클래스를 써서 개발했다고 해서 POJO 방식으로 개발했다고 생각한다. POJO는 객체지향적인 자바 언어의 기본에 충실하게 만들어져야 하기 때문이다.

진정한 POJO란 객체지향적인 원리에 충실하면서, 환경과 기술에 종속되지 않고 필요에 따라 재활용될 수 있는 방식으로 설계된 오브젝트를 말한다.

#### POJO의 장점
특정한 기술과 환경에 종속되지 않는 프로젝트는 그만큼 깔끔한 코드가 될 수 있다. 또 POJO로 개발된 코드는 자동화된 테스트에 매우 유리하다.  
객체지향적인 설계를 자유롭게 적용할 수 있다는 것도 큰 장점이다.

스프링은 POJO를 이용한 엔터프라이즈 애플리케이션 개발을 목적으로 하는 프레임워크라고 했다. 스프링은 비즈니스 로직의 복잡함과 엔터프라이즈 기술의 복잡함을 분리해서  
구성할 수 있게 도와준다. 하지만 자신은 기술영역에만 관여하지 비즈니스 로직을 담당하는 POJO에서는 모습을 감춘다. POJO 프레임워크로서 스프링은 자신을 직접 노출하지  
않으면서 애플리케이션을 POJO로 쉽게 개발할 수 있게 지원해준다.





